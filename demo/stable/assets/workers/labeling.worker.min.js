const t=new class{#t;#n;#i;constructor(){}#s(t){if(t<0)return t;let n=t;for(;this.#n[n]!==n;)n=this.#n[n];let i=t;for(;this.#n[i]!==i;){const t=this.#n[i];this.#n[i]=n,i=t}return n}#e(t,n){this.#n[this.#s(t)]=this.#s(n)}regenerateLabels(t,n,i,s){void 0!==this.#t&&this.#t===s||(this.#t=s,this.#n=new Int32Array(s),this.#i=new Int32Array(s));for(let s=0;s<i[0];s++)for(let e=0;e<i[1];e++)for(let l=0;l<i[2];l++){const i=n[0]*s+n[1]*e+n[2]*l;this.#n[i]=i,this.#i[i]=-1;const o=t[i];if(o>0){const a=i-n[0],h=i-n[1],r=i-n[2];let u=0;s>0&&(u=t[a]);let d=0;e>0&&(d=t[h]);let f=0;l>0&&(f=t[r]);let c=0;s>0&&(c=this.#i[a]);let b=0;e>0&&(b=this.#i[h]);let w=0;l>0&&(w=this.#i[r]),u!==o&&d!==o&&f!==o?this.#i[i]=i:u===o&&d!==o&&f!==o?this.#i[i]=this.#s(c):u!==o&&d===o&&f!==o?this.#i[i]=this.#s(b):u!==o&&d!==o&&f===o?this.#i[i]=this.#s(w):u!==o&&d===o&&f===o?(this.#e(b,w),this.#i[i]=this.#s(b)):u===o&&d!==o&&f===o?(this.#e(c,w),this.#i[i]=this.#s(c)):u===o&&d===o&&f!==o?(this.#e(c,b),this.#i[i]=this.#s(c)):u===o&&d===o&&f===o&&(this.#e(c,b),this.#e(c,w),this.#i[i]=this.#s(c))}}}#l(t,n){const i=new Array(n.length);let s=t,e=0;for(let t=n.length-1;t>0;--t)e=n[t],i[t]=Math.floor(s/e),s-=i[t]*e;return i[0]=s,i}#o(t,n){const i={};for(let s=0;s<this.#i.length;s++){const e=this.#s(this.#i[s]);if(e>=0){const l=this.#l(s,n),o=i[e];void 0===o?i[e]={id:t[s],sum:l,count:1}:(o.sum[0]+=l[0],o.sum[1]+=l[1],o.sum[2]+=l[2],o.count++)}}return Object.values(i).map((t=>{const n=Array(t.sum.length).fill(0);for(let i=0;i<t.sum.length;i++)n[i]=t.sum[i]/t.count;return{id:t.id,centroidIndex:n,count:t.count}}))}calculateFromEvent(t){const n=t.imageBuffer,i=t.unitVectors,s=t.sizes,e=t.totalSize;return this.regenerateLabels(n,i,s,e),this.#o(n,i)}};"undefined"==typeof window||window!==window.window?self.addEventListener("message",(function(n){self.postMessage({labels:t.calculateFromEvent(n.data)})})):self.labelingWorker=t;
//# sourceMappingURL=labeling.worker.min.js.map